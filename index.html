<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8">
<title>Lernspiel – Fische</title>
<style>
  body {
    margin: 0;
    overflow: hidden;
    background: url('https://i.postimg.cc/vHq7yj3X/8-C614-C9-A-8-F82-4-FA9-BFCD-1979437-F7-F61.png') no-repeat center center;
    background-size: cover;
  }
  canvas {
    display: block;
  }
</style>
</head>
<body>
<canvas id="gameCanvas"></canvas>

<script>
const canvas = document.getElementById("gameCanvas");
const ctx = canvas.getContext("2d");
canvas.width = window.innerWidth;
canvas.height = window.innerHeight;

const fishImage = new Image();
fishImage.src = "https://i.postimg.cc/QM2Gy02d/21-F6-B391-3-DF7-401-E-A8-E6-208-F0-C7-CC7-C9.png"; // Kopf rechts

// Farben & zugehörige Hue-Werte
const farben = [
  {name: "rot", hue: 0},
  {name: "blau", hue: 200},
  {name: "gelb", hue: 60},
  {name: "gruen", hue: 100},
  {name: "lila", hue: 280},
  {name: "pink", hue: 320}
];

// Sounds (liegen im selben Ordner auf Vercel)
const sounds = {
  aufgabe: "AufgabeFische.mp3",
  rot: "Rot.mp3",
  blau: "Blau.mp3",
  gelb: "Gelb.mp3",
  gruen: "Grün.mp3",
  lila: "Lila.mp3",
  pink: "Pink.mp3"
};

let aktuelleFarbe = null;
let fische = [];

// Fisch-Objekt erstellen
function createFish() {
  const farbe = farben[Math.floor(Math.random() * farben.length)];
  const y = Math.random() * (canvas.height - 100);
  const speed = 2 + Math.random() * 2;
  return {
    x: -100,
    y: y,
    speed: speed,
    farbe: farbe
  };
}

// Anfangs mehrere Fische
for (let i = 0; i < 6; i++) {
  fische.push(createFish());
}

// Spiel-Update
function update() {
  ctx.clearRect(0, 0, canvas.width, canvas.height);

  fische.forEach((fish, index) => {
    fish.x += fish.speed;

    // Fisch zeichnen mit Farbe (Hue)
    ctx.save();
    ctx.filter = `hue-rotate(${fish.farbe.hue}deg)`;
    ctx.drawImage(fishImage, fish.x, fish.y, 80, 50);
    ctx.restore();

    // Wenn außerhalb → neu erstellen (neue Farbe)
    if (fish.x > canvas.width + 100) {
      fische[index] = createFish();
    }
  });

  requestAnimationFrame(update);
}

// Klickprüfung
canvas.addEventListener("click", (e) => {
  const mouseX = e.clientX;
  const mouseY = e.clientY;

  fische.forEach((fish) => {
    if (
      mouseX >= fish.x &&
      mouseX <= fish.x + 80 &&
      mouseY >= fish.y &&
      mouseY <= fish.y + 50
    ) {
      if (fish.farbe.name === aktuelleFarbe) {
        alert("✅ Richtig!");
      } else {
        alert("❌ Falsch!");
      }
    }
  });
});

// Ansage starten
function startAnsage() {
  setTimeout(() => {
    const audioAufgabe = new Audio(sounds.aufgabe);
    audioAufgabe.play();
    audioAufgabe.addEventListener("ended", () => {
      const zufallsFarbe = farben[Math.floor(Math.random() * farben.length)].name;
      aktuelleFarbe = zufallsFarbe;
      const farbAudio = new Audio(sounds[zufallsFarbe]);
      farbAudio.play();
    });
  }, 500);
}

fishImage.onload = () => {
  update();
  startAnsage();
};
</script>
</body>
</html>
